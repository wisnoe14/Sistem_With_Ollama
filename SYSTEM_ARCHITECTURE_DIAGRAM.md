# ğŸ¨ FRONTEND-BACKEND INTEGRATION DIAGRAM

## ğŸ“Š System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE                           â”‚
â”‚                    (Browser / React Frontend)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTP POST
                        â”‚ /api/v1/endpoints/conversation/*
                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND API SERVER                            â”‚
â”‚                   (FastAPI / Python 3.11)                        â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           conversation.py (API Routes)                  â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ POST /generate-simulation-questions                  â”‚    â”‚
â”‚  â”‚  â€¢ POST /predict                                         â”‚    â”‚
â”‚  â”‚  â€¢ POST /next-question                                   â”‚    â”‚
â”‚  â”‚  â€¢ POST /update-status-dihubungi                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                       â”‚                                          â”‚
â”‚                       â”‚ calls                                    â”‚
â”‚                       â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         gpt_service.py (Core Logic)                     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ generate_question()                                  â”‚    â”‚
â”‚  â”‚  â€¢ determine_winback_next_goal()                        â”‚    â”‚
â”‚  â”‚  â€¢ check_winback_goals()                                â”‚    â”‚
â”‚  â”‚  â€¢ generate_winback_question()                          â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Data: WINBACK_QUESTIONS (9 goals)                      â”‚    â”‚
â”‚  â”‚        CONVERSATION_GOALS                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FRONTEND   â”‚
â”‚ CSSimulation â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. User selects "winback" topic
       â”‚    and clicks "Dihubungi"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /generate-simulation-questions      â”‚
â”‚                                          â”‚
â”‚ Request:                                 â”‚
â”‚ {                                        â”‚
â”‚   "customer_id": "C001",                 â”‚
â”‚   "topic": "winback",                    â”‚
â”‚   "conversation": [],                    â”‚
â”‚   "user": "cs@iconnet.com"               â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Backend generates greeting
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response:                                â”‚
â”‚ {                                        â”‚
â”‚   "question": "Selamat pagi...",         â”‚
â”‚   "options": ["Ya", "Tidak", ...],       â”‚
â”‚   "is_closing": false,                   â”‚
â”‚   "question_id": "wb_001",               â”‚
â”‚   "customer_name": "John Doe",           â”‚
â”‚   "cs_name": "Agent Smith"               â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. User answers "Ya, benar"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /generate-simulation-questions      â”‚
â”‚                                          â”‚
â”‚ Request:                                 â”‚
â”‚ {                                        â”‚
â”‚   "customer_id": "C001",                 â”‚
â”‚   "topic": "winback",                    â”‚
â”‚   "conversation": [                      â”‚
â”‚     {"q": "Selamat pagi...",             â”‚
â”‚      "a": "Ya, benar"}                   â”‚
â”‚   ],                                     â”‚
â”‚   "user": "cs@iconnet.com"               â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. Backend determines next goal
       â”‚    â†’ check_status
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response:                                â”‚
â”‚ {                                        â”‚
â”‚   "question": "Baik Bapak/Ibu...",       â”‚
â”‚   "options": ["Masih aktif",             â”‚
â”‚               "Sudah berhenti",          â”‚
â”‚               "Ada gangguan"],           â”‚
â”‚   "is_closing": false,                   â”‚
â”‚   "question_id": "wb_002"                â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 5. User answers "Ada gangguan"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND BRANCHING LOGIC                  â”‚
â”‚                                          â”‚
â”‚ determine_winback_next_goal()            â”‚
â”‚   â†’ Reads answer: "Ada gangguan"         â”‚
â”‚   â†’ Branch detected: complaint_check     â”‚
â”‚   â†’ Returns: complaint_check             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 6. Generate complaint_check Q
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response:                                â”‚
â”‚ {                                        â”‚
â”‚   "question": "Apakah Bapak/Ibu...",     â”‚
â”‚   "options": ["Bersedia lanjut",         â”‚
â”‚               "Tidak pasti",             â”‚
â”‚               "Tidak berminat"],         â”‚
â”‚   "is_closing": false,                   â”‚
â”‚   "question_id": "wb_003"                â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 7. User answers "Bersedia lanjut"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND SUB-BRANCHING LOGIC              â”‚
â”‚                                          â”‚
â”‚ determine_winback_next_goal()            â”‚
â”‚   â†’ Reads complaint_check answer         â”‚
â”‚   â†’ "Bersedia" detected                  â”‚
â”‚   â†’ Route to: closing                    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 8. Generate closing message
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response:                                â”‚
â”‚ {                                        â”‚
â”‚   "question": "Terima kasih...",         â”‚
â”‚   "options": ["Selesai"],                â”‚
â”‚   "is_closing": true,                    â”‚
â”‚   "question_id": "wb_009"                â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 9. Frontend detects is_closing
       â”‚    â†’ Calls /predict endpoint
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /predict                            â”‚
â”‚                                          â”‚
â”‚ Request:                                 â”‚
â”‚ {                                        â”‚
â”‚   "customer_id": "C001",                 â”‚
â”‚   "topic": "winback",                    â”‚
â”‚   "conversation": [                      â”‚
â”‚     {"q": "greeting", "a": "Ya"},        â”‚
â”‚     {"q": "check", "a": "gangguan"},     â”‚
â”‚     {"q": "complaint", "a": "bersedia"}  â”‚
â”‚   ]                                      â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 10. Backend generates prediction
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response:                                â”‚
â”‚ {                                        â”‚
â”‚   "result": {                            â”‚
â”‚     "status": "KEMUNGKINAN TERTARIK",    â”‚
â”‚     "alasan": "Customer menunjukkan...", â”‚
â”‚     "estimasi_pembayaran": "23 Oct"      â”‚
â”‚   }                                      â”‚
â”‚ }                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 11. Frontend navigates to result
       â”‚     page & saves to history
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RESULT PAGE â”‚
â”‚  + HISTORY   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Winback Flow Decision Tree

```
                    START
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ greeting_identityâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  check_status   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚
        â–¼            â–¼            â–¼
   [berhenti]   [gangguan]   [masih aktif]
        â”‚            â”‚            â”‚
        â”‚            â”‚            â”‚
        â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ reason_  â”‚  â”‚complaint_â”‚  â”‚  promo_  â”‚
â”‚ inquiry  â”‚  â”‚  check   â”‚  â”‚  offer   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚              â”‚
     â”‚        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
     â”‚        â–¼         â–¼    â–¼         â–¼
     â”‚   [bersedia] [pertimbangkan] [tertarik] [tidak]
     â”‚        â”‚         â”‚    â”‚         â”‚
     â”‚        â”‚         â–¼    â”‚         â”‚
     â”‚        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
     â”‚        â”‚    â”‚response_â”‚         â”‚
     â”‚        â”‚    â”‚handling â”‚         â”‚
     â”‚        â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â”‚
     â”‚        â”‚         â”‚              â”‚
     â”‚        â”‚         â–¼              â–¼
     â”‚        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚        â”‚    â”‚ closing â”‚   â”‚payment_ â”‚
     â”‚        â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚confirm  â”‚
     â”‚        â”‚                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚        â”‚                       â”‚
     â”‚        â–¼                       â–¼
     â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   â”‚ closing â”‚            â”‚ closing â”‚
     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ closing â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Component Interaction

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CSSimulation.tsx                      â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚          State Management                   â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ topic: Topic                             â”‚     â”‚
â”‚  â”‚  â€¢ currentQuestion: ScenarioItem | null     â”‚     â”‚
â”‚  â”‚  â€¢ conversation: ConversationItem[]         â”‚     â”‚
â”‚  â”‚  â€¢ result: Prediction | null                â”‚     â”‚
â”‚  â”‚  â€¢ loading: boolean                         â”‚     â”‚
â”‚  â”‚  â€¢ statusDihubungi: string | null           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚          Event Handlers                     â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ handleStatusDihubungi(status)           â”‚     â”‚
â”‚  â”‚    â””â”€> Calls API to start conversation      â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ handleAnswer(answer)                    â”‚     â”‚
â”‚  â”‚    â””â”€> Saves answer, calls next question   â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ handleBack()                            â”‚     â”‚
â”‚  â”‚    â””â”€> Navigate to previous question       â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ fetchPrediction()                       â”‚     â”‚
â”‚  â”‚    â””â”€> Gets final prediction               â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚          Child Components                   â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ ScenarioControls                        â”‚     â”‚
â”‚  â”‚    â””â”€> Topic selector & exit button        â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ QuestionBox                             â”‚     â”‚
â”‚  â”‚    â””â”€> Display Q, options, manual input    â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â€¢ CustomDropdown                          â”‚     â”‚
â”‚  â”‚    â””â”€> Fancy dropdown for topic selector   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Data Models

### Frontend Types (TypeScript)
```typescript
type Topic = "telecollection" | "retention" | "winback";

type ConversationItem = {
    q: string;    // Question
    a: string;    // Answer
};

type ScenarioItem = {
    q: string;                // Question text
    options: string[];        // Answer options
    is_closing?: boolean;     // Is this closing?
    question_followup?: string; // Split question part 2
};

type Prediction = {
    status: string;            // Result status
    alasan: string;            // Reason
    estimasi_pembayaran: string; // Payment estimate
    customer_id?: string;
    mode?: string;
};
```

### Backend Models (Python)
```python
class GenerateSimulationRequest(BaseModel):
    customer_id: str
    topic: str
    conversation: List[Dict[str, str]]
    user: Optional[str] = None

class ConversationPredictRequest(BaseModel):
    customer_id: str
    topic: str
    conversation: List[Dict[str, str]]
```

---

## ğŸ¨ UI Component Tree

```
App.tsx
  â””â”€ BrowserRouter
      â””â”€ Routes
          â”œâ”€ Route "/" â†’ LoginPage
          â”œâ”€ Route "/Home" â†’ Home
          â””â”€ Route "/cs-simulation" â†’ CSSimulation
              â”‚
              â”œâ”€ Header
              â”‚   â”œâ”€ Logo
              â”‚   â””â”€ Customer Name Badge
              â”‚
              â”œâ”€ Sidebar (ScenarioControls)
              â”‚   â”œâ”€ Topic Selector (CustomDropdown)
              â”‚   â”‚   â”œâ”€ Telecollection
              â”‚   â”‚   â”œâ”€ Retention
              â”‚   â”‚   â””â”€ Winback âœ…
              â”‚   â””â”€ Exit Button
              â”‚
              â””â”€ Main Content
                  â”œâ”€ Status Dihubungi Section
                  â”‚   â”œâ”€ Dihubungi Button
                  â”‚   â””â”€ Tidak Dihubungi Button
                  â”‚       â””â”€ Alasan Dropdown
                  â”‚
                  â””â”€ QuestionBox (if dihubungi)
                      â”œâ”€ Question Display
                      â”œâ”€ Options Grid (4 buttons)
                      â”œâ”€ "ATAU" Divider
                      â”œâ”€ Manual Input Textarea
                      â””â”€ Lanjutkan Button
```

---

## ğŸ” Security & Authentication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Login     â”‚
â”‚   Page      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ POST /auth/login
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Auth    â”‚
â”‚  âœ… Validate     â”‚
â”‚  âœ… Generate JWT â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Return: { token, user_email, user_name }
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  sessionStorage  â”‚
â”‚  â€¢ token         â”‚
â”‚  â€¢ user_email    â”‚
â”‚  â€¢ customer_id   â”‚
â”‚  â€¢ customer_name â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ All subsequent requests include:
       â”‚ Authorization: Bearer {token}
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Protected API   â”‚
â”‚  Endpoints       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š State Management Flow

```
User Action â†’ Event Handler â†’ API Call â†’ State Update â†’ UI Re-render
    â”‚              â”‚              â”‚            â”‚            â”‚
    â”‚              â”‚              â”‚            â”‚            â”‚
    â–¼              â–¼              â–¼            â–¼            â–¼
Click "Dihubungi" â†’ handleStatusDihubungi() â†’ POST /generate â†’ setCurrentQuestion() â†’ QuestionBox shows
    â”‚
    â–¼
Enter Answer â†’ handleAnswer() â†’ POST /generate â†’ setConversation() â†’ Update history
    â”‚                                              setCurrentQuestion()
    â–¼
Repeat until is_closing = true
    â”‚
    â–¼
Detect Closing â†’ fetchPrediction() â†’ POST /predict â†’ setResult() â†’ Navigate to /result
    â”‚                                                   addToHistory()
    â–¼
Show Result
```

---

**Status:** âœ… **SYSTEM ARCHITECTURE DOCUMENTED**  
**Date:** 2025-01-20  
**Coverage:** Frontend â†”ï¸ Backend â†”ï¸ Database
